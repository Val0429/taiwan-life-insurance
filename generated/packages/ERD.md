# Prisma Markdown
> Generated by [`prisma-markdown`](https://github.com/samchon/prisma-markdown)

- [系統維護管理作業](#系統維護管理作業)
- [設施設備修繕採購作業](#設施設備修繕採購作業)
- [資產管理作業](#資產管理作業)
- [租賃管理作業](#租賃管理作業)

## 系統維護管理作業
```mermaid
erDiagram
"User" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String username UK
    String password
    String role1
    String role2 "nullable"
    Int role1Permission "nullable"
    Int role2Permission "nullable"
    String name
    String email "nullable"
    String description "nullable"
    Boolean recycled
}
"Logs" {
    Int id PK
    String level
    String log
    String service
    String context "nullable"
    String action "nullable"
    String message "nullable"
    String exception "nullable"
    String userId "nullable"
    String auditerId "nullable"
    String relatedId "nullable"
    DateTime timestamp
}
"Files" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String fileName
    Int fileSize
    String contentType
    String filePath
    String description "nullable"
    Boolean isPublic "nullable"
    String incomeAndExpenseDetailId FK "nullable"
    String propertyId FK "nullable"
    String propertyEquipmentId FK "nullable"
    String propertyRentalUnitId FK "nullable"
    String propertyRentalContractId FK "nullable"
    String propertyEquipmentMaintanceDetailId FK "nullable"
}
"IncomeAndExpenseCategory" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String type
    String name
    String description "nullable"
    String loopPeriod "nullable"
    Boolean isDefault
    Boolean recycled
}
"IncomeAndExpenseSubject" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String categoryId FK
    String description "nullable"
    String loopPeriod "nullable"
    Float loopLife "nullable"
    String propertyId FK
    String propertyRentalContractId FK
    String propertyEquipmentRepairRequestId FK
}
"IncomeAndExpenseDetail" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    Int amount
    String description "nullable"
    DateTime executionDate "nullable"
    Boolean isPending
    String incomeAndExpenseSubjectId FK
}
"Files" }o--|| "IncomeAndExpenseDetail" : incomeAndExpenseDetail
"IncomeAndExpenseSubject" }o--|| "IncomeAndExpenseCategory" : category
"IncomeAndExpenseDetail" }o--|| "IncomeAndExpenseSubject" : incomeAndExpenseSubject
```

### `User`
管理台銀使用者帳號

所有權限皆可修改自己的密碼
Admin 可以新建/修改/刪除帳號，與提出修改密碼請求
可以刪除與停用。所有資料表惟有User可刪除

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `username`: 使用者名稱
  - `password`: 使用者密碼
  - `role1`: Admin (系統管理者) / Operator (作業人員) / Reviewer (審核人員)
  - `role2`: Admin (系統管理者) / Operator (作業人員) / Reviewer (審核人員)
  - `role1Permission`: 0x00000000. 資產管理作業 / 租賃管理作業 / 設施設備修繕採購作業 / 會計帳務管理作業 / 事務管理作業 / 決策支援及報表作業 / 系統維護管理作業
  - `role2Permission`: 0x00000000. 資產管理作業 / 租賃管理作業 / 設施設備修繕採購作業 / 會計帳務管理作業 / 事務管理作業 / 決策支援及報表作業 / 系統維護管理作業
  - `name`: 真實姓名或法人名稱
  - `email`: Email通知消息時使用
  - `description`: 其他備註
  - `recycled`: 是否停用

### `Logs`
日誌
additional param: context, action, err
userId, auditerId, relatedId

**Properties**
  - `id`: 
  - `level`: 
  - `log`: 
  - `service`: 
  - `context`: 例: ApiLogger
  - `action`: 例: POST /auth/login
  - `message`: 
  - `exception`: 
  - `userId`: 
  - `auditerId`: 
  - `relatedId`: 
  - `timestamp`: 

### `Files`
上傳檔案

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `fileName`: 
  - `fileSize`: 
  - `contentType`: 
  - `filePath`: 檔案存放路徑
  - `description`: 備註
  - `isPublic`: 是否需要權限存取
  - `incomeAndExpenseDetailId`: 關聯資料，回收處理使用 ///
  - `propertyId`: 
  - `propertyEquipmentId`: 
  - `propertyRentalUnitId`: 
  - `propertyRentalContractId`: 
  - `propertyEquipmentMaintanceDetailId`: 

### `IncomeAndExpenseCategory`
收入支出分類

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `type`: 收入 (Income) 或支出 (Expense)
  - `name`: 收支類別名稱，例如: 電費
  - `description`: 收支類別詳細說明
  - `loopPeriod`: 循環週期。格式: Linux Crontab Syntax
  - `isDefault`: 是否為出廠預設類別。預設則不可刪除
  - `recycled`: 是否回收 (D)

### `IncomeAndExpenseSubject`
在資產或出租合約中，實際代表可收支項目，可執行的主體

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `categoryId`: 關連到哪一個 收支項目類別
  - `description`: 額外詳細說明
  - `loopPeriod`: 覆蓋循環週期。格式: Linux Crontab Syntax
  - `loopLife`: 循環年限
  - `propertyId`: 屬於哪個資產
  - `propertyRentalContractId`: 屬於哪個資產出租合約
  - `propertyEquipmentRepairRequestId`: 屬於哪個設備維修請求

### `IncomeAndExpenseDetail`
代表一期帳單支付，或收入入帳

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `amount`: 金額。單位: 新台幣
  - `description`: 額外詳細說明
  - `executionDate`: 實際繳納日期
  - `isPending`: 自動建立後，即進入待處理狀態。直至填寫完畢
  - `incomeAndExpenseSubjectId`: 屬於哪個收支項目主體


## 設施設備修繕採購作業
```mermaid
erDiagram
"PropertyEquipmentMaintanceSubject" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String loopPeriod "nullable"
    String description "nullable"
    String propertyEquipmentMaintanceVendorId FK
}
"PropertyEquipmentMaintanceDetail" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String description "nullable"
    DateTime executionDate "nullable"
    Boolean isPending
    String propertyEquipmentMaintanceSubjectId FK
}
"PropertyEquipmentRepairRequest" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String status
    String description
    String propertyEquipmentId FK
    String customerId FK
    Boolean recycled
}
"PropertyEquipmentMaintanceVendor" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String serialNumber
    String name
    String contactName
    String contactEmail
    String contactPhone
    String contactMobile
    String description
    Boolean recycled
    Boolean auditee
}
"PropertyEquipmentPartsInventory" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String name
    Int items
    String description
    String propertyId FK "nullable"
    Boolean recycled
    Boolean auditee
}
"PropertyEquipmentMaintanceSubject" }o--|| "PropertyEquipmentMaintanceVendor" : propertyEquipmentMaintanceVendor
"PropertyEquipmentMaintanceDetail" }o--|| "PropertyEquipmentMaintanceSubject" : propertyEquipmentMaintanceSubject
```

### `PropertyEquipmentMaintanceSubject`
在設備中，實際代表定期保養項目，可執行的主體

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `loopPeriod`: 循環週期。格式: Linux Crontab Syntax
  - `description`: 額外保養詳細內容
  - `propertyEquipmentMaintanceVendorId`: 屬於哪個維護廠商

### `PropertyEquipmentMaintanceDetail`
代表一期定期保養

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `description`: 額外詳細說明
  - `executionDate`: 實際執行日期
  - `isPending`: 自動建立後，即進入待處理狀態。直至填寫完畢
  - `propertyEquipmentMaintanceSubjectId`: 屬於哪個設備定期保養主體

### `PropertyEquipmentRepairRequest`
設備維修請求
申請日期即建立日期

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `status`: 維修狀態: 待處理 (Pending) 派工中 (Dispatched) 已完工 (Complete)
  - `description`: 維修內容詳細描述
  - `propertyEquipmentId`: 維修哪個設備
  - `customerId`: 屬於哪個租戶
  - `recycled`: 資料已被刪除、或審核完成

### `PropertyEquipmentMaintanceVendor`
設備定期保養廠商

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `serialNumber`: 廠商統一編號
  - `name`: 廠商名稱
  - `contactName`: 廠商聯絡人
  - `contactEmail`: 聯絡人email
  - `contactPhone`: 聯絡電話
  - `contactMobile`: 聯絡手機
  - `description`: 廠商服務內容與詳細資料
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料

### `PropertyEquipmentPartsInventory`
零件庫存資料

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `name`: 零件名稱
  - `items`: 有多少
  - `description`: 詳細描述
  - `propertyId`: 屬於哪個資產
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料


## 資產管理作業
```mermaid
erDiagram
"PropertyGroup" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String type
    String status
    String name
    Boolean recycled
    Boolean auditee
    String auditType "nullable"
    String auditDescribe "nullable"
    String auditParentId FK "nullable"
}
"Property" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String status
    String type
    String address
    Float area
    DateTime acquireDate
    Int amount
    Float depreciationRate "nullable"
    Float depreciationLife "nullable"
    String propertyGroupId FK
    Boolean recycled
    Boolean auditee
}
"PropertyEquipment" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String serial
    String name
    String description
    DateTime acquireDate
    String propertyEquipmentMaintanceSubjectId FK
    String propertyId FK
    String propertyRentalUnitId FK "nullable"
    Boolean recycled
    Boolean auditee
}
"PropertyGroup" |o--o| "PropertyGroup" : auditParent
"Property" }o--|| "PropertyGroup" : propertyGroup
"PropertyEquipment" }o--|| "Property" : property
```

### `PropertyGroup`
資產群組

可作為受審核主體
審核過程存入Logs
審核過程與紀錄
1: 提交審核: userId (提交人) / tenantId (PropertyGroupId) / relatedId
2: 接受或駁回審核: userId (提交人) / tenantId (PropertyGroupId) / relatedId (審核人) / message (接受或駁回訊息)

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `type`: 資產群組類別: 投資用 (Investment) 自用 (Own)
  - `status`: 資產狀態: 持有中 (Holding) 已售出 (Sold)
  - `name`: 資產群組名稱。例: 葉財記大樓
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料
  - `auditType`: 審核類別: 新增 / 修改 / 刪除
  - `auditDescribe`: 描述修改內容: 用來提示審核員，我修改了什麼?
  - `auditParentId`: 審核資料父層

### `Property`
資產

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `status`: 資產狀態: 持有中 (Holding) 已售出 (Complete)
  - `type`: 建物類別: Land / Building
  - `address`: 建物地址。例: 台北市大安區通化段五小段492地號
  - `area`: 建物面積(平方公尺)。例: 608.00
  - `acquireDate`: 取得年月日
  - `amount`: 帳面金額
  - `depreciationRate`: Building: 折舊率
  - `depreciationLife`: Building: 折舊年限。單位: 年
  - `propertyGroupId`: 屬於哪個資產群組
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料

### `PropertyEquipment`
資產所屬設備

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `serial`: 設備編號
  - `name`: 設備名稱
  - `description`: 詳細描述
  - `acquireDate`: 取得年月日
  - `propertyEquipmentMaintanceSubjectId`: 設備保養主體
  - `propertyId`: 屬於哪個資產
  - `propertyRentalUnitId`: 屬於哪個資產空間
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料


## 租賃管理作業
```mermaid
erDiagram
"PropertyRentalUnit" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String status
    String address "nullable"
    Float area
    String contactName
    String contactEmail
    String contactPhone
    String contactMobile
    Int amount "nullable"
    Boolean isDefault
    String propertyId FK
    Boolean recycled
    Boolean auditee
}
"PropertyRentalContract" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String status
    Int amount
    Int rentalPeriod
    DateTime rentalStartDate
    DateTime rentalEndDate
    Int rentFreePeriod
    DateTime rentFreeEndDate
    String specialTerms "nullable"
    String propertyRentalUnitId FK
    String customerId FK
    Boolean recycled
    Boolean auditee
}
"Customer" {
    String id PK
    DateTime createdAt
    DateTime updatedAt
    String username UK
    String password
    String name
    String email
    String phone
    String mobile
    String description "nullable"
    Boolean recycled
    Boolean auditee
}
"PropertyRentalContract" |o--|| "PropertyRentalUnit" : propertyRentalUnit
"PropertyRentalContract" }o--|| "Customer" : customer
```

### `PropertyRentalUnit`
資產空間。只有資產空間才可與用戶訂立合約

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `status`: 資產空間狀態: 待處理 (Pending) 待出租 (Renting) 已出租 (Rented) 已售出 (Sold)
  - `address`: 招租地址。空置空間可不填地址
  - `area`: 招租面積(平方公尺)。例: 608.00
  - `contactName`: 聯絡人姓名
  - `contactEmail`: 聯絡人email
  - `contactPhone`: 聯絡電話
  - `contactMobile`: 聯絡手機
  - `amount`: 擬租租金。單位: 新台幣。空置空間可不填租金
  - `isDefault`: 是否為出廠預設類別 (空置空間)。預設則不可刪除
  - `propertyId`: 屬於哪個資產
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料

### `PropertyRentalContract`
資產出租合約。只有資產空間才可與用戶訂立出租合約
(Fayu) 討論: 3. 租賃契約租期內維護，如租金調整、提前終止、契約內容變更、補充契約、申請租金減免等。

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `status`: 資產出租合約狀態: 已簽約 (Signed) 已續約 (Renewed) 已中斷 (Interrupted) 已完成 (Completed)
  - `amount`: 出租金額
  - `rentalPeriod`: 總租期
  - `rentalStartDate`: 出租開始日期
  - `rentalEndDate`: 出租結束日期
  - `rentFreePeriod`: 免租金裝潢期限
  - `rentFreeEndDate`: 免租金裝潢截止日期
  - `specialTerms`: 特約條款
  - `propertyRentalUnitId`: 屬於哪個資產空間
  - `customerId`: 屬於哪個租戶
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料

### `Customer`
租用資產客戶

**Properties**
  - `id`: 
  - `createdAt`: 
  - `updatedAt`: 
  - `username`: 客戶名稱
  - `password`: 客戶密碼
  - `name`: 真實姓名或法人名稱
  - `email`: Email通知消息時使用
  - `phone`: 聯絡電話
  - `mobile`: 聯絡手機
  - `description`: 其他備註
  - `recycled`: 資料已被刪除、或審核完成
  - `auditee`: 是否為審核相關資料